zerops:
  - setup: prod
    build:
      base: rust@latest
      buildCommands:
        - cargo build --release
      deployFiles:
        # The "." at the end extracts the binary to the root directory
        - target/release/rust-hello-world-app .
    run:
      base: rust@latest
      ports:
        - port: 3000
          httpSupport: true
      # Now the binary is in the root, so this path works perfectly
      start: ./rust-hello-world-app

  - setup: dev
    build:
      base: rust@latest
      buildCommands:
        - cargo build
      deployFiles:
        # Extracting everything to root for an easy development environment
        - target/debug/rust-hello-world-app .
        - src
        - Cargo.toml
        - Cargo.lock
    run:
      base: rust@latest
      ports:
        - port: 3000
          httpSupport: true
      envVariables:
        RUST_BACKTRACE: "1"
      start: ./rust-hello-world-app